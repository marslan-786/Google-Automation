<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Command Center | Railway</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        /* --- CORE THEME --- */
        :root { 
            --bg-dark: #050505; 
            --panel-bg: #0f1115; 
            --border: #333; 
            --neon-green: #00ff41; 
            --neon-red: #ff003c; 
            --text-main: #c9d1d9; 
        }

        body { 
            margin: 0; 
            font-family: 'Consolas', 'Monaco', monospace; 
            background: var(--bg-dark); 
            color: var(--text-main); 
            height: 100vh; 
            overflow: hidden; 
            display: flex; 
            flex-direction: column;
        }

        /* --- LAYOUT GRID --- */
        .main-container {
            display: grid;
            grid-template-columns: 320px 1fr; /* Left Gallery fixed, Right flexible */
            grid-template-rows: 1fr 200px;    /* Top Content, Bottom Terminal */
            height: 100vh;
            width: 100vw;
        }

        /* --- 1. LEFT: GALLERY PANEL --- */
        .gallery-area {
            grid-row: 1 / 3; /* Full height */
            background: #000;
            border-right: 1px solid var(--neon-green);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .gallery-header {
            padding: 10px;
            background: #111;
            color: var(--neon-green);
            text-align: center;
            border-bottom: 1px solid #333;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 14px;
            letter-spacing: 1px;
        }

        #gallery-feed {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .snapshot {
            width: 100%;
            border: 1px solid #333;
            border-radius: 4px;
            opacity: 0.8;
            transition: 0.2s;
        }
        .snapshot:first-child {
            border: 2px solid var(--neon-green); /* Latest image highlighted */
            opacity: 1;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
        }
        .snapshot:hover { opacity: 1; transform: scale(1.02); }

        /* --- 2. RIGHT TOP: CONTROLS --- */
        .controls-area {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
        }

        .logo { font-size: 20px; color: #fff; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 10px; }
        .logo span { color: var(--neon-green); }

        .input-group { display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 11px; color: #666; font-weight: bold; text-transform: uppercase; }
        
        input, select, textarea {
            background: #161b22;
            border: 1px solid #30363d;
            color: #fff;
            padding: 10px;
            font-family: inherit;
            border-radius: 4px;
            outline: none;
        }
        input:focus, textarea:focus { border-color: var(--neon-green); }
        textarea { height: 80px; resize: none; font-size: 11px; }

        .action-bar { display: flex; gap: 10px; margin-top: 10px; }
        button {
            flex: 1;
            padding: 15px;
            font-weight: bold;
            text-transform: uppercase;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            font-family: inherit;
        }
        .btn-start { background: #238636; color: white; }
        .btn-start:hover { background: #2ea043; box-shadow: 0 0 15px rgba(46, 160, 67, 0.4); }
        .btn-stop { background: #da3633; color: white; }
        .btn-stop:hover { background: #f85149; }

        /* --- 3. RIGHT BOTTOM: TERMINAL --- */
        .terminal-area {
            background: #0d1117;
            border-top: 1px solid #333;
            padding: 10px;
            font-size: 12px;
            overflow-y: auto;
            color: #8b949e;
        }
        
        .log-line { margin-bottom: 4px; border-bottom: 1px solid #161b22; padding-bottom: 2px; display: flex; }
        .log-time { color: #666; margin-right: 10px; min-width: 80px; }
        .log-msg { color: #c9d1d9; }
        .log-msg.error { color: var(--neon-red); }
        .log-msg.success { color: var(--neon-green); }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

    </style>
</head>
<body>

<div class="main-container">

    <div class="gallery-area">
        <div class="gallery-header">ðŸ“¡ Live Feed (Pixel View)</div>
        <div id="gallery-feed">
            <div style="text-align:center; color:#444; margin-top:50px;">Waiting for Stream...</div>
        </div>
    </div>

    <div style="display:flex; flex-direction:column; height:100%;">
        
        <div class="controls-area">
            <div class="logo">GOOGLE <span>MASTER</span> BOT <small style="font-size:10px; color:#666;">v2.0 (Railway)</small></div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div class="input-group">
                    <label>Naming Mode</label>
                    <select id="mode" onchange="toggleCustom()">
                        <option value="random">Random (Ali.Khan.99x)</option>
                        <option value="custom">Custom (ButtSahb01, 02..)</option>
                    </select>
                </div>
                
                <div class="input-group" id="customInput" style="display: none;">
                    <label>Base Name</label>
                    <input type="text" id="customBase" placeholder="e.g. ButtSahb">
                </div>

                <div class="input-group">
                    <label>Account Password</label>
                    <input type="text" id="password" value="Pakistan@786">
                </div>
            </div>

            <div class="input-group">
                <label>Proxy List (Format: user:pass@ip:port)</label>
                <textarea id="proxies" placeholder="Paste proxies here..."></textarea>
            </div>

            <div class="action-bar">
                <button class="btn-start" onclick="startBot()">âš¡ Initialize Bot</button>
                <button class="btn-stop" onclick="stopBot()">ðŸ’€ Kill Process</button>
            </div>
        </div>

        <div class="terminal-area" id="terminal">
            <div class="log-line">
                <span class="log-time">[SYSTEM]</span>
                <span class="log-msg">Ready to launch. Waiting for user input...</span>
            </div>
        </div>
    </div>

</div>

<script>
    const socket = io();
    const term = document.getElementById('terminal');
    const gallery = document.getElementById('gallery-feed');

    // Toggle Custom Input
    function toggleCustom() {
        const mode = document.getElementById('mode').value;
        document.getElementById('customInput').style.display = mode === 'custom' ? 'block' : 'none';
    }

    // --- SOCKET LISTENERS ---

    socket.on('log', (msg) => {
        const now = new Date().toLocaleTimeString();
        const div = document.createElement('div');
        div.className = 'log-line';
        
        // Check for keywords to colorize
        let msgClass = 'log-msg';
        if(msg.includes('Error') || msg.includes('Failed')) msgClass += ' error';
        if(msg.includes('Success') || msg.includes('Created')) msgClass += ' success';

        div.innerHTML = `<span class="log-time">[${now}]</span><span class="${msgClass}">${msg}</span>`;
        term.appendChild(div);
        term.scrollTop = term.scrollHeight;
    });

    socket.on('screen_update', (base64) => {
        // Clear "Waiting..." text if present
        if(gallery.innerText.includes('Waiting')) gallery.innerHTML = '';

        const img = document.createElement('img');
        img.src = 'data:image/jpeg;base64,' + base64;
        img.className = 'snapshot';
        
        // Add new image to TOP
        gallery.prepend(img);

        // Limit to 15 images to save browser memory
        if (gallery.children.length > 15) {
            gallery.removeChild(gallery.lastChild);
        }
    });

    // --- ACTIONS ---

    function startBot() {
        const proxies = document.getElementById('proxies').value;
        const mode = document.getElementById('mode').value;
        const customBase = document.getElementById('customBase').value;
        const password = document.getElementById('password').value;

        if(mode === 'custom' && !customBase) {
            alert('Please enter a base name for custom mode!');
            return;
        }

        socket.emit('start_bot', { mode, customBase, password, proxies });
        addLog('Command sent: STARTING ENGINE...');
    }

    function stopBot() {
        socket.emit('stop_bot');
        addLog('Command sent: STOPPING...');
    }

    function addLog(text) {
        const now = new Date().toLocaleTimeString();
        term.innerHTML += `<div class="log-line"><span class="log-time">[USER]</span><span class="log-msg">${text}</span></div>`;
        term.scrollTop = term.scrollHeight;
    }
</script>

</body>
</html>
